<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Editorial</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="../../assets/css/writeups_style.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Editorial</h1><br/><p>Realizo un escaneo de puertos</p><p>   </p><p>Encuentro el puerto 21 (ssh) y el puerto 80 (http) abiertos</p><p>   </p><p>Añado el dns a mi lista /etc/hosts</p><p>   </p><p>Hay una sección que es Publish with us que tiene potencial como vector de ataque</p><p>   <img src="images/95-1.png" alt="images/95-1.png" /></p><p>   </p><p>Puesto que puedo subir archivos y hay textbox</p><p>   <img src="images/95-2.png" alt="images/95-2.png" /></p><p>   </p><p>Hago una enumeracion de subdirectorios y de dns para ver si hay algún login o algún vector con potencial.</p><p>   </p><p>En la enumeración de subdirectorios encuentro el endpoint de upload. que es el mismo que menciono arriba</p><p>   <img src="images/95-3.png" alt="images/95-3.png" /></p><p>   </p><p>Para saber que vulnerabilidad podemos usar voy a interceptar el tráfico con Burpsuite para estudiar la reacción del servidor</p><p>   </p><p>Al parecer en book information realiza una busqueda dentro del propio servidor por lo que puede que sea vulnerable a <strong>SSRF (Server Side Request Forgery)</strong></p><p>   <img src="images/95-4.png" alt="images/95-4.png" /></p><p>   </p><p>Cuando una aplicación hace una llamada a una URL (por ejemplo a una API), un atacante puede podría editar la consulta para que esa llamada se haga a otra dirección. </p><p>   <img src="images/95-5.png" alt="images/95-5.png" /></p><p>   <img src="images/95-6.png" alt="images/95-6.png" /></p><p>   </p><p>Para que se ejecute esto tengo que darle al botón preview</p><p>   </p><p>Si en la url le mando el localhost y el puerto vulnerable me devuelve esto.</p><p>   <img src="images/95-7.png" alt="images/95-7.png" /></p><p>   </p><p>Ahora a la ruta de arriba le realizo un <strong>GET</strong>, el cual me devuelve el siguiente mensaje</p><p>   <img src="images/95-8.png" alt="images/95-8.png" /></p><p>   </p><p>Como se puede ver hay distintos endpoints</p><p>   </p><p>El endpoint authors parece un buen punto</p><p>   </p><p>Envío la solicitud y me da las creds de un usuario</p><p>   <img src="images/95-9.png" alt="images/95-9.png" /></p><p>   <img src="images/95-10.png" alt="images/95-10.png" /></p><p>   <img src="images/95-11.png" alt="images/95-11.png" /></p><p>   </p><p>Accedo a través de <strong>SSH</strong> y obtengo la flag de <strong>user.txt</strong></p><p>   <img src="images/95-12.png" alt="images/95-12.png" /></p><p>   </p><p>Tras rebuscar encuentro dentro de la carpeta apps un directorio .git</p><p>   <img src="images/95-13.png" alt="images/95-13.png" /></p><p>   </p><p>En busca de commits</p><p>   </p><p>En la carpeta logs encontramos diferentes commits</p><p>   </p><p>Uno muy interesante es este</p><p>   <strong>1e84a036b2f33c59e2390730699a488c65643d28</strong></p><p>   </p><p>Dentro del commit si bajamos un poco encontramos otro usuario llamado prod con sus respectivas crendeciales</p><p>   <img src="images/95-14.png" alt="images/95-14.png" /></p><p>   </p><p>Dentro del user prod puedo ver que me permite ejecutar un comando como root</p><p>   <img src="images/95-15.png" alt="images/95-15.png" /></p><p>   </p><p>Miro que hace la script.</p><p>   </p><p>Al parecer usa una librería para clonar</p><p>   <img src="images/95-16.png" alt="images/95-16.png" /></p><p>   </p><p>Esta librería es vulnerable a un<strong> RCE CVE-2022-24439</strong></p><p>   </p><p>Ejecuto el siguiente comando y puedo obtener el ver la info del archivo root.txt</p><p>   <img src="images/95-17.png" alt="images/95-17.png" /></p></div>
</body>
</html>
