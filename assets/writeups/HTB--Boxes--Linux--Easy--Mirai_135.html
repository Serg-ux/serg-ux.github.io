<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Mirai</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="../../assets/css/writeups_style.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Mirai</h1><br/><p>Portscan</p><p></p><p>	<strong>nmap -sVC -p- --open -sS --min-rate 5000 -v -n --stats-every=5s -Pn -oN mirai_scan &lt;IP&gt;</strong></p><p></p><p>Services Discovered:</p><p></p><p>	22 		ssh		OpenSSH 6.7p1 Debian 5+deb8u3 (protocol 2.0)</p><p>	53 		domain 	dnsmasq 2.76</p><p>	80 		http		lighttpd 1.4.35</p><p>	1456 		upnp    	Platinum UPnP 1.0.5.13</p><p>	32400	http		Plex Media Server httpd</p><p>	32469	upnp		Platinum UPnP 1.0.5.13</p><p></p><p>In 32400 port I find a login page for Plex.</p><p></p><p><img src="images/135-1.png" alt="images/135-1.png" /></p><p></p><p>I will start  with this login. I try to create a new acc for register, but i receive this advertice</p><p></p><p><img src="images/135-2.png" alt="images/135-2.png" /></p><p></p><p>I don&#39;t find anything interesting on port 80 </p><p></p><p>it returns a blank page </p><p></p><p>I analyze the answer it gives me with Burpsuite</p><p></p><p><img src="images/135-3.png" alt="images/135-3.png" /></p><p></p><p>I see that the response give me X-Pi-Hole</p><p></p><p>The Pi-holeÂ® is a <a href="https://en.wikipedia.org/wiki/DNS_Sinkhole">DNS sinkhole</a> that protects your devices from unwanted content without installing any client-side software</p><p></p><p>Default route to admin dashboard is admin</p><p></p><p><img src="images/135-4.png" alt="images/135-4.png" /></p><p></p><p>I search the default creds and i use them</p><p></p><p>pi:raspberry</p><p></p><p>I recycle the same creds in SSH and i receive the shell for user</p><p></p><p><img src="images/135-5.png" alt="images/135-5.png" /></p><p></p><p>I make sudo -l to see what i can execute as a root</p><p></p><p><img src="images/135-6.png" alt="images/135-6.png" /></p><p></p><p>Hmm interesting</p><p></p><p>I check the devices connected with <strong>lsblk</strong></p><p></p><p><img src="images/135-7.png" alt="images/135-7.png" /></p><p></p><p>The route of the usb is /media/usbstick</p><p></p><p>I access to the usbstick and there is a important archieve</p><p></p><p><img src="images/135-8.png" alt="images/135-8.png" /></p><p></p><p>Forensic time :/</p><p></p><p>I have to create a image of the Usbstick with <strong>dcfldd</strong>, a tool for for copying and converting files </p><p></p><p>	<strong>dcfldd if=/dev/sdb of=/tmp/usb.dd hash=md5,sha1 hashlog=/tmp/hashlog.txt</strong></p><p></p><p><img src="images/135-9.png" alt="images/135-9.png" /></p><p></p><p>Compare the hashes</p><p></p><p>	<strong>dcfldd if=/dev/sdb vf=/tmp/usb.dd verifylog=/tmp/verifylog.txt</strong></p><p></p><p>Send the image to my machine to apply forensic tools (Exfiltration)</p><p></p><p><img src="images/135-10.png" alt="images/135-10.png" /></p><p></p><p><img src="images/135-11.png" alt="images/135-11.png" /></p><p></p><p><img src="images/135-12.png" alt="images/135-12.png" /></p><p></p><p>I will do fls to list the files and directories in the file image</p><p></p><p>I can see the root.txt flag</p><p></p><p>I try the <strong>strings</strong> command. This show me the sequences of printable chars from a file.</p><p></p><p><img src="images/135-13.png" alt="images/135-13.png" /></p></div>
</body>
</html>
